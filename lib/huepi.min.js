!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.huepi=t():e.huepi=t()}(this,function(){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return n(e,[{key:"On",value:function(){return this.on=!0,this}},{key:"Off",value:function(){return this.on=!1,this}},{key:"SetHSB",value:function(e,t,r){return this.hue=Math.round(e),this.sat=Math.round(t),this.bri=Math.round(r),this}},{key:"SetHue",value:function(e){return this.hue=Math.round(e),this}},{key:"SetSaturation",value:function(e){return this.sat=Math.round(e),this}},{key:"SetBrightness",value:function(e){return this.bri=Math.round(e),this}},{key:"SetHueAngSatBri",value:function(e,t,r){for(;e<0;)e+=360;return e%=360,this.SetHSB(Math.round(e/360*65535),Math.round(255*t),Math.round(255*r))}},{key:"SetRGB",value:function(e,t,r){var i;return i=u.HelperRGBtoHueAngSatBri(e,t,r),this.SetHueAngSatBri(i.Ang,i.Sat,i.Bri)}},{key:"SetCT",value:function(e){return this.ct=Math.round(e),this}},{key:"SetColortemperature",value:function(e){return this.SetCT(u.HelperColortemperaturetoCT(e))}},{key:"SetXY",value:function(e,t){return this.xy=[e,t],this}},{key:"AlertSelect",value:function(){return this.alert="select",this}},{key:"AlertLSelect",value:function(){return this.alert="lselect",this}},{key:"AlertNone",value:function(){return this.alert="none",this}},{key:"EffectColorloop",value:function(){return this.effect="colorloop",this}},{key:"EffectNone",value:function(){return this.effect="none",this}},{key:"SetTransitiontime",value:function(e){return void 0!==e&&(this.transitiontime=e),this}},{key:"Get",value:function(){return JSON.stringify(this)}}]),e}(),u=function(){function t(){i(this,t),this.version="1.5.0",this.LocalBridges=[],this.ScanningNetwork=!1,this.ScanProgress=0,this.BridgeIP="",this.BridgeID="",this.Username="",this.BridgeCache={},this.BridgeCacheAutosave=!0,this._BridgeCacheLoad(),this.BridgeConfig={},this.BridgeName="",this.Lights=[],this.LightIds=[],this.Groups=[],this.GroupIds=[],this.Schedules=[],this.Scenes=[],this.Sensors=[],this.Rules=[]}return n(t,[{key:"_BridgeCacheLoad",value:function(){this.BridgeCache={};try{if("undefined"!=typeof window){var t=localStorage.huepiBridgeCache||"{}";this.BridgeCache=JSON.parse(t)}else if(void 0!==e&&e.exports){var i=r(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}()),n=i.readFileSync("huepiBridgeCache.json");this.BridgeCache=JSON.parse(n.toString())}}catch(e){}}},{key:"_BridgeCacheAddCurrent",value:function(){this.BridgeCache[this.BridgeID]=this.Username,this.BridgeCacheAutosave&&this._BridgeCacheSave()}},{key:"_BridgeCacheRemoveCurrent",value:function(){this.BridgeCache[this.BridgeID]===this.Username&&(delete this.BridgeCache[this.BridgeID],this.BridgeCacheAutosave&&this._BridgeCacheSave())}},{key:"_BridgeCacheSelectFromLocalBridges",value:function(){if(this.LocalBridges.length>0&&(this.BridgeIP=this.LocalBridges[0].internalipaddress||"",this.BridgeID=this.LocalBridges[0].id.toLowerCase()||"",!this.BridgeCache[this.BridgeID]))for(var e=1;e<this.LocalBridges.length;e++){if(this.BridgeID=this.LocalBridges[e].id.toLowerCase(),this.BridgeCache[this.BridgeID]){this.BridgeIP=this.LocalBridges[e].internalipaddress;break}this.BridgeID=""}this.Username=this.BridgeCache[this.BridgeID]||""}},{key:"_BridgeCacheSave",value:function(){try{if("undefined"!=typeof window)localStorage.huepiBridgeCache=JSON.stringify(this.BridgeCache);else if(void 0!==e&&e.exports){var t=r(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}());t.writeFileSync("huepiBridgeCache.json",JSON.stringify(this.BridgeCache))}}catch(e){}}},{key:"_NetworkDiscoverLocalIPs",value:function(){var e=[],t=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection,r=new t({iceServers:[]});return r.createDataChannel(""),new Promise(function(t){r.onicecandidate=function(i){if(!i.candidate)return r.close(),t(e);var n=/^candidate:.+ (\S+) \d+ typ/.exec(i.candidate.candidate)[1];return-1===e.indexOf(n)&&e.push(n),e},r.createOffer(function(e){r.setLocalDescription(e)},function(){})})}},{key:"_NetworkDiscoverLocalBridges",value:function(e){var t=this;return this.ScanProgress=0,new Promise(function(r){for(var i=0;i<e.length;i++)!function(i){for(var n=e[i].slice(0,e[i].lastIndexOf(".")+1),o=1;o<=16;o++)!function(e){var r=void 0;for(r[e]=0;r[e]<256;)t.BridgeGetConfig(n+e,3e3).then(function(r){t.LocalBridges.push({internalipaddress:n+e,id:r.bridgeid.toLowerCase()})}).then().catch().then(function(){!1===t.ScanningNetwork?r[e]=256:r[e]+=16})}(o);r()}(i)})}},{key:"NetworkDiscoverLocalBridges",value:function(){var e=this;return this.ScanningNetwork=!0,this.BridgeIP=this.BridgeID=this.BridgeName=this.Username="",this.LocalBridges=[],new Promise(function(t,r){e._NetworkDiscoverLocalIPs().then(function(i){e._NetworkDiscoverLocalBridges(i).then(function(){e.LocalBridges.length>0?(e._BridgeCacheSelectFromLocalBridges(),t()):r()})})})}},{key:"PortalDiscoverLocalBridges",value:function(){var e=this;return this.BridgeIP=this.BridgeID=this.BridgeName=this.Username="",this.LocalBridges=[],new Promise(function(t,r){fetch("https://www.meethue.com/api/nupnp").then(function(e){return e.json()}).then(function(i){i.length>0?i[0].internalipaddress?(e.LocalBridges=i,e._BridgeCacheSelectFromLocalBridges(),t(i)):r("No Bridges found via Portal"):r(i)}).catch(function(e){r(e)})})}},{key:"BridgeGetConfig",value:function(e,t){var r=this;return e=e||this.BridgeIP,t=t||6e4,new Promise(function(i,n){fetch("http://"+e+"/api/config/",{timeout:t}).then(function(e){return e.json()}).then(function(t){t.bridgeid?(r.BridgeIP===e&&(r.BridgeConfig=t,r.BridgeConfig.bridgeid?r.BridgeID=r.BridgeConfig.bridgeid.toLowerCase():r.BridgeID="",r.BridgeName=r.BridgeConfig.name,r.Username=r.BridgeCache[r.BridgeID],void 0===r.Username&&(r.Username="")),i(t)):n("this BridgeIP is not a hue Bridge")}).catch(function(e){n(e)})})}},{key:"BridgeGetDescription",value:function(e,t){var r=this;return e=e||this.BridgeIP,t=t||6e4,new Promise(function(i,n){fetch("http://"+e+"/description.xml",{timeout:t}).then(function(e){return e.json()}).then(function(e){e.indexOf("hue_logo_0.png")>0?(e.indexOf("<serialNumber>")>0&&(r.BridgeID=e.substr(14+e.indexOf("<serialNumber>"),e.indexOf("</serialNumber>")-e.indexOf("<serialNumber>")-14).toLowerCase()),e.indexOf("<friendlyName>")>0&&(r.BridgeName=e.substr(14+e.indexOf("<friendlyName>"),e.indexOf("</friendlyName>")-e.indexOf("<friendlyName>")-14)),r.Username=r.BridgeCache[r.BridgeID],void 0===r.Username&&(r.BridgeID=r.BridgeID.slice(0,6)+"fffe"+r.BridgeID.slice(6,12),r.Username=r.BridgeCache[r.BridgeID],void 0===r.Username&&(r.Username="")),i(e)):n("this BridgeIP is not a hue Bridge")}).catch(function(e){n(e)})})}},{key:"BridgeGetData",value:function(){var e=this;return new Promise(function(t,r){""===e.Username?r("Username must be set before calling BridgeGetData"):fetch("http://"+e.BridgeIP+"/api/"+e.Username).then(function(e){return e.json()}).then(function(i){if(void 0!==i.config){e.BridgeConfig=i.config,e.BridgeConfig.bridgeid?e.BridgeID=e.BridgeConfig.bridgeid.toLowerCase():e.BridgeID="",e.BridgeName=e.BridgeConfig.name,e.Lights=i.lights,e.LightIds=[];for(var n in e.Lights)e.LightIds.push(n);e.Groups=i.groups,e.GroupIds=[];for(var o in e.Groups)e.GroupIds.push(o);e.Schedules=i.schedules,e.Scenes=i.scenes,e.Sensors=i.sensors,e.Rules=i.rules,e.BridgeName=e.BridgeConfig.name,t(i)}else""!==e.Username&&e._BridgeCacheRemoveCurrent(),e.Username="",r("Username is no longer whitelisted")}).catch(function(e){r(e)})})}},{key:"BridgeCreateUser",value:function(e){var t=this;return e=e||"WebInterface",new Promise(function(r,i){fetch("http://"+t.BridgeIP+"/api",{method:"POST",body:'{"devicetype": "huepi#'+e+'"}'}).then(function(e){return e.json()}).then(function(e){e[0]&&e[0].success?(t.Username=e[0].success.username,t._BridgeCacheAddCurrent(),r(e)):i(e)}).catch(function(e){i(e)})})}},{key:"BridgeDeleteUser",value:function(e){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/config/whitelist/"+e,{method:"DELETE"})}},{key:"LightGetId",value:function(e){return"number"==typeof e&&e<=this.LightIds.length?this.LightIds[e-1]:e}},{key:"LightGetNr",value:function(e){return"string"==typeof e?this.LightIds.indexOf(e)+1:e}},{key:"LightsGetData",value:function(){var e=this;return new Promise(function(t,r){fetch("http://"+e.BridgeIP+"/api/"+e.Username+"/lights").then(function(e){return e.json()}).then(function(i){if(i){e.Lights=i,e.LightIds=[];for(var n in e.Lights)e.LightIds.push(n);t(i)}else r(i)}).catch(function(e){r(e)})})}},{key:"LightsSearchForNew",value:function(){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/lights",{method:"POST"})}},{key:"LightsGetNew",value:function(){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/lights/new")}},{key:"LightSetName",value:function(e,t){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/lights/"+this.LightGetId(e),{method:"PUT",body:'{"name" : "'+t+'"}'})}},{key:"LightSetState",value:function(e,t){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/lights/"+this.LightGetId(e)+"/state",{method:"PUT",body:t.Get()})}},{key:"LightOn",value:function(e,t){var r=void 0;return r=new o,r.On(),r.SetTransitiontime(t),this.LightSetState(e,r)}},{key:"LightOff",value:function(e,t){var r=void 0;return r=new o,r.Off(),r.SetTransitiontime(t),this.LightSetState(e,r)}},{key:"LightSetHSB",value:function(e,r,i,n,o){var u=360*r/65535,a=i/255,s=n/255,h=t.HelperHueAngSatBritoRGB(u,a,s),c=t.HelperRGBtoXY(h.Red,h.Green,h.Blue);return Promise.all([this.LightSetBrightness(e,n,o),this.LightSetXY(e,c.x,c.y,o)])}},{key:"LightSetHue",value:function(e,t,r){var i=void 0;return i=new o,i.SetHue(t),i.SetTransitiontime(r),this.LightSetState(e,i)}},{key:"LightSetSaturation",value:function(e,t,r){var i=void 0;return i=new o,i.SetSaturation(t),i.SetTransitiontime(r),this.LightSetState(e,i)}},{key:"LightSetBrightness",value:function(e,t,r){var i=void 0;return i=new o,i.SetBrightness(t),i.SetTransitiontime(r),this.LightSetState(e,i)}},{key:"LightSetHueAngSatBri",value:function(e,t,r,i,n){for(;t<0;)t+=360;return t%=360,this.LightSetHSB(e,t/360*65535,255*r,255*i,n)}},{key:"LightSetRGB",value:function(e,r,i,n,o){var u=t.HelperRGBtoXY(r,i,n),a=t.HelperRGBtoHueAngSatBri(r,i,n);return Promise.all([this.LightSetBrightness(e,255*a.Bri),this.LightSetXY(e,u.x,u.y,o)])}},{key:"LightSetCT",value:function(e,r,i){var n=this.Lights[this.LightGetId(e)].modelid;if(t.HelperModelCapableCT(n)){var u=void 0;return u=new o,u.SetCT(r),u.SetTransitiontime(i),this.LightSetState(e,u)}var a=t.HelperColortemperaturetoRGB(t.HelperCTtoColortemperature(r)),s=t.HelperRGBtoXY(a.Red,a.Green,a.Blue);return this.LightSetXY(e,s.x,s.y,i)}},{key:"LightSetColortemperature",value:function(e,r,i){return this.LightSetCT(e,t.HelperColortemperaturetoCT(r),i)}},{key:"LightSetXY",value:function(e,r,i,n){var u=this.Lights[this.LightGetId(e)].modelid;if(t.HelperModelCapableXY(u)){var a=void 0;a=new o;var s=t.HelperGamutXYforModel(r,i,u);return a.SetXY(s.x,s.y),a.SetTransitiontime(n),this.LightSetState(e,a)}var h=t.HelperXYtoRGB(r,i),c=t.HelperRGBtoColortemperature(h.Red,h.Green,h.Blue);return this.LightSetColortemperature(e,c,n)}},{key:"LightAlertSelect",value:function(e,t){var r=void 0;return r=new o,r.AlertSelect(),r.SetTransitiontime(t),this.LightSetState(e,r)}},{key:"LightAlertLSelect",value:function(e,t){var r=void 0;return r=new o,r.AlertLSelect(),r.SetTransitiontime(t),this.LightSetState(e,r)}},{key:"LightAlertNone",value:function(e,t){var r=void 0;return r=new o,r.AlertNone(),r.SetTransitiontime(t),this.LightSetState(e,r)}},{key:"LightEffectColorloop",value:function(e,t){var r=void 0;return r=new o,r.EffectColorloop(),r.SetTransitiontime(t),this.LightSetState(e,r)}},{key:"LightEffectNone",value:function(e,t){var r=void 0;return r=new o,r.EffectNone(),r.SetTransitiontime(t),this.LightSetState(e,r)}},{key:"GroupGetId",value:function(e){if("number"==typeof e){if(0===e)return"0";if(e>0&&e<=this.GroupIds.length)return this.GroupIds[e-1]}return e}},{key:"GroupGetNr",value:function(e){return"string"==typeof e?this.GroupIds.indexOf(e)+1:e}},{key:"GroupsGetData",value:function(){var e=this;return new Promise(function(t,r){fetch("http://"+e.BridgeIP+"/api/"+e.Username+"/groups").then(function(e){return e.json()}).then(function(i){if(i){e.Groups=i,e.GroupIds=[];for(var n in e.Groups)e.GroupIds.push(n);t(i)}else r(i)}).catch(function(e){r(e)})})}},{key:"GroupsGetZero",value:function(){var e=this;return new Promise(function(t,r){fetch("http://"+e.BridgeIP+"/api/"+e.Username+"/groups/0").then(function(e){return e.json()}).then(function(i){i?(e.Groups[0]=i,t(i)):r(i)}).catch(function(e){r(e)})})}},{key:"GroupCreate",value:function(e,r){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/groups/",{method:"POST",body:'{"name": "'+e+'" , "lights":'+t.HelperToStringArray(r)+"}"})}},{key:"GroupSetName",value:function(e,t){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/groups/"+this.GroupGetId(e),{method:"PUT",body:'{"name": "'+t+'"}'})}},{key:"GroupSetLights",value:function(e,r){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/groups/"+this.GroupGetId(e),{method:"PUT",body:'{"lights":'+t.HelperToStringArray(r)+"}"})}},{key:"GroupSetAttributes",value:function(e,r,i){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/groups/"+this.GroupGetId(e),{method:"PUT",body:'{"name": "'+r+'", "lights":'+t.HelperToStringArray(i)+"}"})}},{key:"GroupDelete",value:function(e){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/groups/"+this.GroupGetId(e),{method:"DELETE"})}},{key:"GroupSetState",value:function(e,t){return fetch("http://"+this.BridgeIP+"/api/"+this.Username+"/groups/"+this.GroupGetId(e)+"/action",{method:"PUT",body:t.Get()})}},{key:"GroupOn",value:function(e,t){var r=void 0;return r=new o,r.On(),r.SetTransitiontime(t),this.GroupSetState(e,r)}},{key:"GroupOff",value:function(e,t){var r=void 0;return r=new o,r.Off(),r.SetTransitiontime(t),this.GroupSetState(e,r)}},{key:"GroupSetHSB",value:function(e,r,i,n,o){var u=360*r/65535,a=i/255,s=n/255,h=t.HelperHueAngSatBritoRGB(u,a,s),c=t.HelperRGBtoXY(h.Red,h.Green,h.Blue);return Promise.all([this.GroupSetBrightness(e,n,o),this.GroupSetXY(e,c.x,c.y,o)])}},{key:"GroupSetHue",value:function(e,t,r){var i=void 0;return i=new o,i.SetHue(t),i.SetTransitiontime(r),this.GroupSetState(e,i)}},{key:"GroupSetSaturation",value:function(e,t,r){var i=void 0;return i=new o,i.SetSaturation(t),i.SetTransitiontime(r),this.GroupSetState(e,i)}},{key:"GroupSetBrightness",value:function(e,t,r){var i=void 0;return i=new o,i.SetBrightness(t),i.SetTransitiontime(r),this.GroupSetState(e,i)}},{key:"GroupSetHueAngSatBri",value:function(e,t,r,i,n){for(;t<0;)t+=360;return t%=360,this.GroupSetHSB(e,t/360*65535,255*r,255*i,n)}},{key:"GroupSetRGB",value:function(e,r,i,n,o){var u=t.HelperRGBtoHueAngSatBri(r,i,n);return this.GroupSetHueAngSatBri(e,u.Ang,u.Sat,u.Bri,o)}},{key:"GroupSetCT",value:function(e,t,r){var i=[];if(e=this.GroupGetId(e),i="0"===e?this.LightIds:this.Groups[e].lights,0!==i.length){for(var n=[],u=0;u<i.length;u++)n.push(this.LightSetCT(i[u],t,r));return Promise.all(n)}var a=void 0;return a=new o,a.SetCT(t),a.SetTransitiontime(r),this.GroupSetState(e,a)}},{key:"GroupSetColortemperature",value:function(e,r,i){return this.GroupSetCT(e,t.HelperColortemperaturetoCT(r),i)}},{key:"GroupSetXY",value:function(e,t,r,i){var n=[];if(e=this.GroupGetId(e),n="0"===e?this.LightIds:this.Groups[e].lights,0!==n.length){for(var u=[],a=0;a<n.length;a++)u.push(this.LightSetXY(n[a],t,r,i));return Promise.all(u)}var s=void 0;return s=new o,s.SetXY(t,r),s.SetTransitiontime(i),this.GroupSetState(e,s)}},{key:"GroupAlertSelect",value:function(e,t){var r=void 0;return r=new o,r.AlertSelect(),r.SetTransitiontime(t),this.GroupSetState(e,r)}},{key:"GroupAlertLSelect",value:function(e,t){var r=void 0;return r=new o,r.AlertLSelect(),r.SetTransitiontime(t),this.GroupSetState(e,r)}},{key:"GroupAlertNone",value:function(e,t){var r=void 0;return r=new o,r.AlertNone(),r.SetTransitiontime(t),this.GroupSetState(e,r)}},{key:"GroupEffectColorloop",value:function(e,t){var r=void 0;return r=new o,r.EffectColorloop(),r.SetTransitiontime(t),this.GroupSetState(e,r)}},{key:"GroupEffectNone",value:function(e,t){var r=void 0;return r=new o,r.EffectNone(),r.SetTransitiontime(t),this.GroupSetState(e,r)}},{key:"SchedulesGetData",value:function(){var e=this;return new Promise(function(t,r){fetch("http://"+e.BridgeIP+"/api/"+e.Username+"/schedules").then(function(e){return e.json()}).then(function(i){i?(e.Schedules=i,t(i)):r(i)}).catch(function(e){r(e)})})}},{key:"ScenesGetData",value:function(){var e=this;return new Promise(function(t,r){fetch("http://"+e.BridgeIP+"/api/"+e.Username+"/scenes").then(function(e){return e.json()}).then(function(i){i?(e.Scenes=i,t(i)):r(i)}).catch(function(e){r(e)})})}},{key:"SensorsGetData",value:function(){var e=this;return new Promise(function(t,r){fetch("http://"+e.BridgeIP+"/api/"+e.Username+"/sensors").then(function(e){return e.json()}).then(function(i){i?(e.Sensors=i,t(i)):r(i)}).catch(function(e){r(e)})})}},{key:"RulesGetData",value:function(){var e=this;return new Promise(function(t,r){fetch("http://"+e.BridgeIP+"/api/"+e.Username+"/rules").then(function(e){return e.json()}).then(function(i){i?(e.Rules=i,t(i)):r(i)}).catch(function(e){r(e)})})}}],[{key:"HelperModelCapableCT",value:function(e){var t=e.slice(0,3);return"LCT"===t||"LLM"===t||"LTW"===t||"LLC020"===e||"LST002"===e}},{key:"HelperModelCapableXY",value:function(e){var t=e.slice(0,3);return"LCT"===t||"LLC"===t||"LST"===t||"LLM001"===e||"LLC020"===e||"LST002"===e}},{key:"HelperRGBtoHueAngSatBri",value:function(e,t,r){var i=void 0,n=void 0,o=void 0,u=Math.min(e,t,r),a=Math.max(e,t,r);return u!==a?(i=e===a?60*(0+(t-r)/(a-u)):t===a?60*(2+(r-e)/(a-u)):60*(4+(e-t)/(a-u)),n=(a-u)/a,o=a):(i=0,n=0,o=a),{Ang:i,Sat:n,Bri:o}}},{key:"HelperHueAngSatBritoRGB",value:function(e,t,r){var i=void 0,n=void 0,o=void 0;if(0===t)i=r,n=r,o=r;else{var u=Math.floor(e/60)%6,a=e/60-u,s=r*(1-t),h=r*(1-t*a),c=r*(1-t*(1-a));switch(u){case 0:i=r,n=c,o=s;break;case 1:i=h,n=r,o=s;break;case 2:i=s,n=r,o=c;break;case 3:i=s,n=h,o=r;break;case 4:i=c,n=s,o=r;break;default:i=r,n=s,o=h}}return{Red:i,Green:n,Blue:o}}},{key:"HelperRGBtoColortemperature",value:function(e,r,i){for(var n=void 0,o=void 0,u=2200,a=6500;a-u>.4;)n=(a+u)/2,o=t.HelperColortemperaturetoRGB(n),o.Blue/o.Red>=i/e?a=n:u=n;return Math.round(n)}},{key:"HelperColortemperaturetoRGB",value:function(e){var t=void 0,r=void 0,i=void 0;return e/=100,e<=66?t=165+e/66*90:(t=e-60,t=329.698727466*Math.pow(t,-.1332047592),t<0&&(t=0),t>255&&(t=255)),e<=66?(r=e,r=99.4708025861*Math.log(r)-161.1195681661,r<0&&(r=0),r>255&&(r=255)):(r=e-60,r=288.1221695283*Math.pow(r,-.0755148492),r<0&&(r=0),r>255&&(r=255)),e>=66?i=255:e<=19?i=0:(i=e-10,i=138.5177312231*Math.log(i)-305.0447927307,i<0&&(i=0),i>255&&(i=255)),{Red:t/255,Green:r/255,Blue:i/255}}},{key:"HelperRGBtoXY",value:function(e,t,r){e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,t>.04045?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92;var i=.664511*e+.154324*t+.162028*r,n=.283881*e+.668433*t+.047685*r,o=88e-6*e+.07231*t+.986039*r;return i+n+o===0?{x:0,y:0}:{x:i/(i+n+o),y:n/(i+n+o)}}},{key:"HelperXYtoRGB",value:function(e,t,r){r=r||1;var i=1-e-t,n=r,o=n/t*e,u=n/t*i,a=1.656492*o-.354851*n-.255038*u,s=.707196*-o+1.655397*n+.036152*u,h=.051713*o-.121364*n+1.01153*u;return a>h&&a>s&&a>1&&(s/=a,h/=a,a=1),a<0&&(a=0),s>h&&s>a&&s>1&&(a/=s,h/=s,s=1),s<0&&(s=0),h>a&&h>s&&h>1&&(a/=h,s/=h,h=1),h<0&&(h=0),a<=.0031308?a*=12.92:a=1.055*Math.pow(a,1/2.4)-.055,s<=.0031308?s*=12.92:s=1.055*Math.pow(s,1/2.4)-.055,h<=.0031308?h*=12.92:h=1.055*Math.pow(h,1/2.4)-.055,a>h&&a>s&&a>1&&(s/=a,h/=a,a=1),a<0&&(a=0),s>h&&s>a&&s>1&&(a/=s,h/=s,s=1),s<0&&(s=0),h>a&&h>s&&h>1&&(a/=h,s/=h,h=1),h<0&&(h=0),{Red:a,Green:s,Blue:h}}},{key:"HelperXYtoRGBforModel",value:function(e,r,i,n){var o=t.HelperGamutXYforModel(e,r,n);return t.HelperXYtoRGB(o.x,o.y,i)}},{key:"HelperGamutXYforModel",value:function(e,t,r){r=r||"LCT001";var i=r.slice(0,3),n=void 0,o=void 0,u=void 0,a=void 0;"LST"!==i&&"LLC"!==i||"LLC020"===r||"LLC002"===r||"LST002"===r?"LCT"!==i&&"LLM"!==i||"LCT010"===r||"LCT014"===r||"LCT011"===r||"LCT012"===r?(n={x:.692,y:.308},o={x:.17,y:.7},u={x:.153,y:.048}):(n={x:.675,y:.322},o={x:.409,y:.518},u={x:.167,y:.04}):(n={x:.704,y:.296},o={x:.2151,y:.7106},u={x:.138,y:.08});var s={x:n.x-u.x,y:n.y-u.y},h={x:o.x-n.x,y:o.y-n.y},c={x:u.x-o.x,y:u.y-o.y},l=(o.x-u.x)*s.y-(o.y-u.y)*s.x,d=(u.x-n.x)*h.y-(u.y-n.y)*h.x,f=(n.x-o.x)*c.y-(n.y-o.y)*c.x,g={x:e-u.x,y:t-u.y},p={x:e-n.x,y:t-n.y},v={x:e-o.x,y:t-o.y},y=g.x*s.y-g.y*s.x,S=p.x*h.y-p.y*h.x,B=v.x*c.y-v.y*c.x;return l*y>=0&&d*S>=0&&f*B>=0?{x:e,y:t}:l*y<=0?(a=(g.x*s.x+g.y*s.y)/(s.x*s.x+s.y*s.y),a>=0&&a<=1?{x:u.x+a*s.x,y:u.y+a*s.y}:a<0?{x:u.x,y:u.y}:{x:n.x,y:n.y}):d*S<=0?(a=(p.x*h.x+p.y*h.y)/(h.x*h.x+h.y*h.y),a>=0&&a<=1?{x:n.x+a*h.x,y:n.y+a*h.y}:a<0?{x:n.x,y:n.y}:{x:o.x,y:o.y}):f*B<=0?(a=(v.x*c.x+v.y*c.y)/(c.x*c.x+c.y*c.y),a>=0&&a<=1?{x:o.x+a*c.x,y:o.y+a*c.y}:a<0?{x:o.x,y:o.y}:{x:u.x,y:u.y}):{x:.5,y:.5}}},{key:"HelperHueAngSatBritoColortemperature",value:function(e,r,i){var n=void 0;return n=t.HelperHueAngSatBritoRGB(e,r,i),t.HelperRGBtoColortemperature(n.Red,n.Green,n.Blue)}},{key:"HelperColortemperaturetoHueAngSatBri",value:function(e){var r=void 0;return r=t.HelperColortemperaturetoRGB(e),t.HelperRGBtoHueAngSatBri(r.Red,r.Green,r.Blue)}},{key:"HelperXYtoColortemperature",value:function(e,r,i){var n=void 0;return n=t.HelperXYtoRGB(e,r,i),t.HelperRGBtoColortemperature(n.Red,n.Green,n.Blue)}},{key:"HelperColortemperaturetoXY",value:function(e){var r=void 0;return r=t.HelperColortemperaturetoRGB(e),t.HelperRGBtoXY(r.Red,r.Green,r.Blue)}},{key:"HelperCTtoColortemperature",value:function(e){return Math.round(1e6/e)}},{key:"HelperColortemperaturetoCT",value:function(e){return Math.round(1e6/e)}},{key:"HelperToStringArray",value:function(e){if("number"==typeof e)return'"'+e.toString()+'"';if("[object Array]"===Object.prototype.toString.call(e)){for(var r="[",i=0;i<e.length;i++)r+=t.HelperToStringArray(e[i]),i<e.length-1&&(r+=",");return r+="]"}return'"'+e+'"'}}]),t}();e.exports={Huepi:u,HuepiLightstate:o},e.exports.default=u}])});